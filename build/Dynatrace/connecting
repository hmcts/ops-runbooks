<h1 id="dynatrace-activegate">Dynatrace ActiveGate</h1>
<h2 id="pre-requisites">Pre-Requisites</h2>

<ul>
<li>Connected to the <a href="https://portal.platform.hmcts.net">VPN</a></li>
</ul>
<h2 id="connecting-to-dynatrace-vms-activegate">Connecting to Dynatrace VMs (ActiveGate)</h2>

<ul>
<li>Dynatrace ActiveGate VMs exist as instances of different VMSS:

<ul>
<li><a href="https://portal.azure.com/#@HMCTS.NET/asset/Microsoft_Azure_Compute/VirtualMachineScaleSet/subscriptions/1baf5470-1c3e-40d3-a6f7-74bfbce4b348/resourceGroups/aks-infra-cftptl-intsvc-rg/providers/Microsoft.Compute/virtualMachineScaleSets/activegate-private-ptl-vmss">Private PTL</a></li>
<li><a href="https://portal.azure.com/#@HMCTS.NET/asset/Microsoft_Azure_Compute/VirtualMachineScaleSet/subscriptions/1baf5470-1c3e-40d3-a6f7-74bfbce4b348/resourceGroups/aks-infra-cftptl-intsvc-rg/providers/Microsoft.Compute/virtualMachineScaleSets/activegate-ptl-vmss">PTL</a></li>
<li><a href="https://portal.azure.com/#@HMCTS.NET/asset/Microsoft_Azure_Compute/VirtualMachineScaleSet/subscriptions/1baf5470-1c3e-40d3-a6f7-74bfbce4b348/resourceGroups/aks-infra-cftptl-intsvc-rg/providers/Microsoft.Compute/virtualMachineScaleSets/activegate-private-nonprod-vmss">Private Nonprod</a></li>
<li><a href="https://portal.azure.com/#@HMCTS.NET/asset/Microsoft_Azure_Compute/VirtualMachineScaleSet/subscriptions/1baf5470-1c3e-40d3-a6f7-74bfbce4b348/resourceGroups/aks-infra-cftptl-intsvc-rg/providers/Microsoft.Compute/virtualMachineScaleSets/activegate-nonprod-vmss">Nonprod</a></li>
</ul></li>
</ul>
<p>Use SSH to connect to the virtual machine, run the below <code>IPList.sh</code> to output available machines to connect to:</p>
<div class="highlight"><pre class="highlight shell" tabindex="0"><code><span class="c"># List all active gate virtual machine IP addresses</span>
./Dynatrace/bin/IPList.sh

<span class="c"># Download key</span>
az keyvault secret download <span class="nt">-f</span> ~/.ssh/dt-key <span class="nt">--vault-name</span> cftptl-intsvc <span class="nt">--name</span> aks-ssh-private-key
<span class="nb">chmod </span>600 ~/.ssh/dt-key

<span class="c"># Connect</span>
ssh <span class="nt">-i</span> ~/.ssh/dt-key azureuser@<span class="o">{</span>replace_me_with_vm_ip<span class="o">}</span>
</code></pre></div>