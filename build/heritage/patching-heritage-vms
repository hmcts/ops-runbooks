<h1 id="patching-heritage-virtual-machines">Patching Heritage Virtual Machines</h1>
<p>This document covers the process for patching a heritage virtual machine and when an update may be required.</p>
<p>See also: <a href="https://tools.hmcts.net/confluence/pages/viewpage.action?spaceKey=~thomas.thornton&amp;title=Patch+Management+-+Short-term+Solution&amp;__ncforminfo=ZnRoLlL-x11bau7g6V7tutFOmtJwTZD7-yXnB-eWT3_clV-xl1Qxr5c4H_WUMTG6TaYD80Sz9YSFCPSYeXiObw==">Confluence documentation on this subject</a>.</p>
<h2 id="when-is-a-reboot-required">When is a reboot required?</h2>
<p>All virtual machines must be restarted once patching has been completed. Linux VMs should only require a single restart, whereas Windows VMs may need to restart multiple times for a single update.</p>
<h3 id="patching-without-rebooting">Patching without rebooting?</h3>
<p>There is potential for Linux VMs to be patched without needing to reboot, however this would incur additional costs to the project.</p>
<p>Ubuntu: Possible, requires <a href="https://ubuntu.com/security/livepatch">subscription</a>. (Entry level UA Essential for $75/year for virtual machines)</p>
<p>RHEL: Possible, requires <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/kernel_administration_guide/applying_patches_with_kernel_live_patching">subscription</a>. Red Hat&rsquo;s kpatch for Red Hat Enterprise Linux 7, is available on a Premium support subscription for $1299 per year. (Limitation: There are no live patches released for RHEL 8.3, 7.8, RHEL 6 and RHEL 5.)</p>
<p>Windows: In-memory patching is not offered for Windows VMs.</p>
<h2 id="how-long-does-a-restart-take">How long does a restart take?</h2>
<p>Linux VMs restart fairly quickly and should come back online within 3-4 minutes. Windows VMs take slightly longer and can often take up to 15 minutes to restart.</p>
<h2 id="what-is-the-process-for-a-restart">What is the process for a restart?</h2>
<p>For all types of patching, the high-level patching process is as follows:</p>

<ol>
<li>A lower environment will be patched prior to Production ( e.g., Non Live Environment (NLE) → Production ).</li>
<li>Ensure a valid backup is available prior to each environment/virtual machine being patched.</li>
<li>Prior to any patching, Platform Operations will contact the Development team; they will be required to stop relevant services/shutdown databases etc. This initial process should be documented if not already.</li>
<li>A restart schedule ( e.g., restart app01 → db01 → app02 → db02 ) is to be provided by the Application team.</li>
<li>Once restarts have been completed, development team to start &amp; test applications.</li>
<li>Once the above is successful, the next environment will be patched with similar steps.</li>
</ol>
